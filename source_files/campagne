:name: Campagne de réadhésion

:description:
  Liste pour campagne de réadhésion.<br>
  On cherche les tiers qui ont été membres au moins une fois dans les quinze dernièrea années.<br>
  L'année à renseigner est la dernière année d'adhésion.<br>
  Le type de tiers est à renseigner.<br>
  Le format de sortie est tiers_id, infos_complémentaires,
  ce qui permet de voir la période d'adhésion.

:query: SELECT
  TIERS_DESC, vue_tiers_infos_complementaires
  FROM tiers
    LEFT JOIN vue_tiers_infos
      ON vue_tiers_infos_tiers = tiers_id
    LEFT JOIN client_sage
      ON client_sage.client_sage_client_final = tiers_id
    LEFT JOIN adhesion_locale
      ON adhesion_locale_client_sage = client_sage_id
    LEFT JOIN type_tiers
      ON tiers_type = type_tiers_id
   WHERE
     (adhesion_locale_ignorer = 0 OR adhesion_locale_ignorer IS NULL)
     AND type_tiers_nom = PARAM
     AND tiers_etat = 1
   GROUP BY tiers_id
   HAVING
     max(adhesion_locale_annee) CONDITION
     AND max(adhesion_locale_annee) >= YEAR(CURDATE())-15

:parameter_list:
- Individu
- Institution

:years: complex

